# ---------------------------------------------------------------------------- #
# Task configs
# ---------------------------------------------------------------------------- #
epochs: 300
mode: train                   # [train, test]
grad_norm_clip: 1
seed: 6

# ---------------------------------------------------------------------------- #
# Experimenet configs
# ---------------------------------------------------------------------------- #
experiment:
  exp_root_path: log
  exp_name: ScanObjectNN_HilbertFormerCls_Adapter_d_48_hc_2_ws_08
  model_path_list: [HilbertFormerINFBetaV3, model_utils]

# ---------------------------------------------------------------------------- #
# Dataset configs
# ---------------------------------------------------------------------------- #
dataset:
  common:
    NAME: ScanObjectNN
    data_path: data
    num_points: 1024
  train:
    split: train
  test:
    split: test

# ---------------------------------------------------------------------------- #
# Dataloader configs
# ---------------------------------------------------------------------------- #
dataloader:
  train:
    batch_size: 32
    num_workers: 8
  test:
    batch_size: 16
    num_workers: 8

# ---------------------------------------------------------------------------- #
# Model configs
# ---------------------------------------------------------------------------- #
model:
  NAME: HilbertFormerINFBetaV3
  n_cls: 15
  n_stage: 4
  d_stem: 3
  d_base: 48
  d_expand: 2.0
  n_base: 1024
  n_expand: 0.5
  k_base: 24
  k_expand: 1.0
  n_dn_blks: [1, 1, 2, 1]
  n_en_blks: [2, 2, 2, 2]
  hc_ps: [5, 4, 3, 2]
  win_szs: [8, 8, 8, 8]
  bias: False
  norm: BN
  act: ReLU
  drop: 0.0

# ---------------------------------------------------------------------------- #
# Loss configs
# ---------------------------------------------------------------------------- #
loss:
  NAME: SmoothCrossEntropy
  use_smoothing: True
  eps: 0.2

# ---------------------------------------------------------------------------- #
# Optimizer configs
# ---------------------------------------------------------------------------- #
optimizer:
  NAME: SGD
  lr: 0.1
  momentum: 0.9
  weight_decay: 1.0e-4
  nesterov: True

# optimizer:
#   NAME: Adam
#   lr: 0.0005
#   betas: [0.9, 0.999]
#   weight_decay: 1.0e-4

# ---------------------------------------------------------------------------- #
# scheduler configs
# ---------------------------------------------------------------------------- #
# scheduler:
#   NAME: step
#   milestones: [140, 180]
#   gamma: 0.1

scheduler:
  NAME: cos
  eta_min: 2.0e-3
