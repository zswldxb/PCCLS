# ---------------------------------------------------------------------------- #
# Task configs
# ---------------------------------------------------------------------------- #
epochs: 300
mode: train                   # [train, test]
grad_norm_clip: 1
# seed: 6

# ---------------------------------------------------------------------------- #
# Experimenet configs
# ---------------------------------------------------------------------------- #
experiment:
  exp_root_path: log/DifferentExpansionLevel
  exp_name: ScanObjectNN_HilbertFormerV1ClsHilbertSeqWinTrans_EL4
  save_file_list: ['main.py', 'build.py', 'datasets.py', 'losses.py', 'utils.py', 'models/HilbertFormerV1Cls.py',
      'models/modules/point_utils.py', 'models/modules/model_utils.py', 'models/modules/expansion_utils.py']

# ---------------------------------------------------------------------------- #
# Dataset configs
# ---------------------------------------------------------------------------- #
dataset:
  common:
    NAME: ScanObjectNN
    data_path: data
    num_points: 1024
  train:
    split: train
  test:
    split: test

# ---------------------------------------------------------------------------- #
# Dataloader configs
# ---------------------------------------------------------------------------- #
dataloader:
  train:
    batch_size: 32
    num_workers: 8
  test:
    batch_size: 16
    num_workers: 8

# ---------------------------------------------------------------------------- #
# Model configs
# ---------------------------------------------------------------------------- #
model:
  NAME: HilbertFormerV1ClsHilbertSeqWinTrans
  num_cls: 15
  num_stg: 4
  dim_stem: 3
  dim_base: 48
  dim_expand: 2.0
  qry_base: 1024
  qry_expand: 0.5
  grp_base: 24
  grp_expand: 1.0
  blk_dns: [1, 1, 2, 1]
  blk_ens: [2, 2, 2, 2]
  hlb_lvl: [4, 3, 2, 1]
  win_sz: [16, 16, 16, 16]
  ratio: 1.0
  drop: 0.0
  norm_name: BN
  act_name: ReLU
  linear_args:
    bias: False
  norm_args:
    eps: 1.0e-5
    momentum: 0.1
  act_args:
    inplace: True

# ---------------------------------------------------------------------------- #
# Loss configs
# ---------------------------------------------------------------------------- #
loss:
  NAME: SmoothCrossEntropy
  use_smoothing: True
  eps: 0.2

# ---------------------------------------------------------------------------- #
# Optimizer configs
# ---------------------------------------------------------------------------- #
optimizer:
  NAME: SGD
  lr: 0.1
  momentum: 0.9
  weight_decay: 1.0e-4
  nesterov: True

# optimizer:
#   NAME: Adam
#   lr: 0.0005
#   betas: [0.9, 0.999]
#   weight_decay: 1.0e-4

# ---------------------------------------------------------------------------- #
# scheduler configs
# ---------------------------------------------------------------------------- #
# scheduler:
#   NAME: step
#   milestones: [140, 180]
#   gamma: 0.1

scheduler:
  NAME: cos
  eta_min: 2.0e-3
